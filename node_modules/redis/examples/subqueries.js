// Sending commands in response to other commands.
// This example runs "type" against every key in the database
//
if (process.env.REDISTOGO_URL) {
	var rtg   = require("url").parse(process.env.REDISTOGO_URL);
	var client = require("redis").createClient(rtg.port, rtg.hostname);

	client.auth(rtg.auth.split(":")[1]);

} else {

	var client = require("redis").createClient();
}
client.keys("*", function (err, keys) {
    keys.forEach(function (key, pos) {
        client.type(key, function (err, keytype) {
            console.log(key + " is " + keytype);
            if (pos === (keys.length - 1)) {
                client.quit();
            }
        });
    });
});
